"use strict";var path=require("path"),commons=require("@permian/commons"),fs=commons.files.fsExtra,createInitdScript=require("./initd-script"),originalFile=!1,createScriptFile=function(t){var r={shortDescription:t.shortDescription,stopScript:"",startScript:""};return t.containers.forEach(function(t){r.startScript+="podman start ".concat(t.name," &&"),r.stopScript+="podman stop ".concat(t.name," &&")}),r.startScript+=" exit 0",r.stopScript+=" exit 0",createInitdScript(r)};function StarterScriptCreator(t,r){var i={starterScript:{dir:"/etc/init.d",scriptFile:"devonian-starter.sh"}};r=commons.lang.assignRecursive(i,r);var e=path.resolve(i.starterScript.dir,i.starterScript.scriptFile);this.apply=function(){return fs.readFile(e).then(function(t){return originalFile=t}).catch(function(){}).then(function(){return fs.writeFile(e,createScriptFile(r))})},this.revert=function(){return originalFile?fs.writeFile(e,originalFile).then(t):t()}}module.exports=Object.freeze({createInstance:function(t,r){return new StarterScriptCreator(t,r)}});